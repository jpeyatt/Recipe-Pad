var RpApp=angular.module("RpApp",["ngRoute","ui.router","ui.bootstrap","ui-notification","ngSanitize","ngAnimate"]).config(["$stateProvider","$urlRouterProvider",function(e,i){i.otherwise("/recipes"),e.state("recipes",{url:"/recipes",templateUrl:"app/views/recipes.html",controller:"RecipesCtrl as vm"}).state("recipe",{url:"/recipe/:recipeId",templateUrl:"app/views/recipe.html",controller:"RecipeCtrl as vm"}).state("newRecipe",{url:"/new-recipe",templateUrl:"app/views/createRecipe.html",controller:"CreateRecipeCtrl as vm"}).state("editRecipe",{url:"/edit-recipe/:recipeId",templateUrl:"app/views/editRecipe.html",controller:"EditRecipeCtrl as vm"})}]);RpApp.value("Genres",["African","American","Asian","Caribbean","European","Oceanian","Mexican","Chicken","Steak","Beef","Ham","Pasta"]),RpApp.controller("CreateRecipeCtrl",["RecipesService","$state","Genres","Notification",function(e,i,n,t){var r=this;r.newRecipe={},r.genres=n,r.newRecipe.genre=void 0,r.newRecipe.ingredients=[],r.addIngredient=function(){r.newRecipe.ingredients.push({measurement:r.newIngredientMeasurement,name:r.newIngredientName}),r.newIngredientMeasurement="",r.newIngredientName=""},r.deleteIngredient=function(e){r.newRecipe.ingredients.splice(e,1)},r.newRecipe.directions=[],r.addDirection=function(){r.newRecipe.directions.push({step:r.newDirectionStep,instructions:r.newDirectionInstructions}),r.newDirectionStep="",r.newDirectionInstructions=""},r.deleteDirection=function(e){r.newRecipe.directions.splice(e,1)},r.createRecipe=function(n){var r={name:n.name,genre:n.genre,description:n.description,prepTime:n.prepTime,cookTime:n.cookTime,rating:n.rating,ingredients:n.ingredients,directions:n.directions};e.create(r).success(function(){t.primary({message:"Recipe successfully created.",delay:2e3}),i.go("recipes")}).error(function(e){console.log("Error: "+e)})},r.ratingHover=function(e){r.overStar=e,r.percent=100*(e/5)},r.ratingStates=[{stateOn:"fa fa-star"}],r.cancelRecipe=function(){i.go("recipes")}}]),RpApp.controller("EditRecipeCtrl",["RecipeService","$state","$stateParams","Genres","Notification",function(e,i,n,t,r){var c=this;c.recipeId=n.recipeId,e.get(n.recipeId).success(function(e){c.recipe=e,console.log("Recipe (id): "+c.recipe._id+" successfully loaded")}).error(function(e){console.log("Error: "+e)}),c.genres=t,c.addIngredient=function(){c.recipe.ingredients.push({measurement:c.newIngredientMeasurement,name:c.newIngredientName}),c.newIngredientMeasurement="",c.newIngredientName=""},c.deleteIngredient=function(e){c.recipe.ingredients.splice(e,1)},c.addDirection=function(){c.recipe.directions.push({step:c.newDirectionStep,instructions:c.newDirectionInstructions}),c.newDirectionStep="",c.newDirectionInstructions=""},c.deleteDirection=function(e){c.recipe.directions.splice(e,1)},c.saveRecipe=function(n){c.updatedRecipe={name:n.name,genre:n.genre,description:n.description,prepTime:n.prepTime,cookTime:n.cookTime,rating:n.rating,ingredients:n.ingredients,directions:n.directions},e.update(c.recipeId,c.updatedRecipe).success(function(){r.primary({message:"Recipe updated",delay:2e3}),i.go("recipes")}).error(function(e){console.log("Error: "+e)})},c.cancelRecipe=function(){i.go("recipes")}}]),RpApp.controller("RecipeCtrl",["RecipeService","$state","$stateParams",function(e,i,n){var t=this;e.get(n.recipeId).success(function(e){t.recipe=e,console.log(e+" successfully loaded")}).error(function(e){console.log("Error: "+e)}),t.goBack=function(){i.go("recipes"),$("html,body").scrollTop(0)}}]),RpApp.controller("RecipesCtrl",["RecipesService","RecipeService","Notification",function(e,i,n){var t=this;t.pageClass="page-recipes",t.loadRecipes=function(){e.get().success(function(e){t.recipes=e}).error(function(e){console.log("Error: "+e)})},t.deleteRecipe=function(e){i["delete"](e).success(function(){n.primary({message:"Recipe deleted successfully",delay:2e3}),t.loadRecipes(),$(".modal-backdrop").fadeOut()})},t.loadRecipes()}]),RpApp.factory("RecipeService",["$http",function(e){return{get:function(i){return e.get("http://localhost:8000/api/recipes/"+i)},update:function(i,n){return e.put("http://localhost:8000/api/recipes/"+i,n)},"delete":function(i){return e["delete"]("http://localhost:8000/api/recipes/"+i)}}}]),RpApp.factory("RecipesService",["$http",function(e){return{get:function(){return e.get("http://localhost:8000/api/recipes")},create:function(i){return e.post("http://localhost:8000/api/recipes",i)}}}]);